<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart Diagnostic Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            font-weight: bold;
        }
        .error { background: #ffebee; border-left: 4px solid #f44336; }
        .success { background: #e8f5e9; border-left: 4px solid #4CAF50; }
        .warning { background: #fff3e0; border-left: 4px solid #ff9800; }
        .result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üîß Cart System Diagnostic</h1>
    <p>This page will help diagnose cart issues on your site.</p>

    <div class="test-section">
        <h2>1. JavaScript Basic Test</h2>
        <button class="test-btn" onclick="testJavaScript()">Test JavaScript</button>
        <div id="jsResult"></div>
    </div>

    <div class="test-section">
        <h2>2. Local Storage Test</h2>
        <button class="test-btn" onclick="testLocalStorage()">Test Local Storage</button>
        <div id="storageResult"></div>
    </div>

    <div class="test-section">
        <h2>3. Cart Functions Test</h2>
        <button class="test-btn" onclick="testCartFunctions()">Test Cart Functions</button>
        <div id="cartResult"></div>
    </div>

    <div class="test-section">
        <h2>4. Modal Test</h2>
        <button class="test-btn" onclick="testModal()">Test Modal</button>
        <div id="modalResult"></div>
        
        <!-- Test Modal -->
        <div id="testModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="background: white; margin: 10% auto; padding: 30px; width: 400px; border-radius: 15px; text-align: center;">
                <h3>üéâ Modal Test Successful!</h3>
                <p>Modal is working correctly.</p>
                <button onclick="closeTestModal()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">Close</button>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>5. Enhanced Garden Ecommerce Test</h2>
        <p>Test the original site:</p>
        <button class="test-btn" onclick="window.open('http://localhost:9090/gar/enhanced-garden-ecommerce/', '_blank')">Open Original Site</button>
        <button class="test-btn" onclick="window.open('http://localhost:9090/gar/working-cart-final.html', '_blank')">Open Working Cart</button>
    </div>

    <div class="test-section">
        <h2>üìã Test Results Summary</h2>
        <div id="summary">
            <p>Run all tests above to see the summary.</p>
        </div>
    </div>

    <script>
        let testResults = {
            javascript: false,
            localStorage: false,
            cartFunctions: false,
            modal: false
        };

        function testJavaScript() {
            try {
                // Test basic JavaScript functionality
                let testVar = "JavaScript is working";
                let testArray = [1, 2, 3];
                let testObj = { test: true };
                
                if (testVar && testArray.length === 3 && testObj.test) {
                    document.getElementById('jsResult').innerHTML = 
                        '<div class="result success">‚úÖ JavaScript is working correctly!</div>';
                    testResults.javascript = true;
                } else {
                    throw new Error('JavaScript test failed');
                }
            } catch (error) {
                document.getElementById('jsResult').innerHTML = 
                    '<div class="result error">‚ùå JavaScript Error: ' + error.message + '</div>';
                testResults.javascript = false;
            }
            updateSummary();
        }

        function testLocalStorage() {
            try {
                // Test localStorage functionality
                localStorage.setItem('cartDiagnosticTest', JSON.stringify({ test: true, timestamp: Date.now() }));
                let retrieved = JSON.parse(localStorage.getItem('cartDiagnosticTest'));
                
                if (retrieved && retrieved.test === true) {
                    document.getElementById('storageResult').innerHTML = 
                        '<div class="result success">‚úÖ Local Storage is working correctly!</div>';
                    testResults.localStorage = true;
                    localStorage.removeItem('cartDiagnosticTest');
                } else {
                    throw new Error('Local storage retrieval failed');
                }
            } catch (error) {
                document.getElementById('storageResult').innerHTML = 
                    '<div class="result error">‚ùå Local Storage Error: ' + error.message + '</div>';
                testResults.localStorage = false;
            }
            updateSummary();
        }

        function testCartFunctions() {
            try {
                // Test cart-like functionality
                let testCart = [];
                
                // Test adding items
                testCart.push({ id: 1, name: 'Test Item', price: 10, quantity: 1 });
                
                // Test updating quantities
                testCart[0].quantity = 2;
                
                // Test calculating total
                let total = testCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                
                if (testCart.length === 1 && testCart[0].quantity === 2 && total === 20) {
                    document.getElementById('cartResult').innerHTML = 
                        '<div class="result success">‚úÖ Cart functions are working correctly!</div>';
                    testResults.cartFunctions = true;
                } else {
                    throw new Error('Cart function test failed');
                }
            } catch (error) {
                document.getElementById('cartResult').innerHTML = 
                    '<div class="result error">‚ùå Cart Functions Error: ' + error.message + '</div>';
                testResults.cartFunctions = false;
            }
            updateSummary();
        }

        function testModal() {
            try {
                // Test modal functionality
                document.getElementById('testModal').style.display = 'block';
                document.getElementById('modalResult').innerHTML = 
                    '<div class="result success">‚úÖ Modal opened successfully! Close it to complete the test.</div>';
                testResults.modal = true;
                updateSummary();
            } catch (error) {
                document.getElementById('modalResult').innerHTML = 
                    '<div class="result error">‚ùå Modal Error: ' + error.message + '</div>';
                testResults.modal = false;
                updateSummary();
            }
        }

        function closeTestModal() {
            document.getElementById('testModal').style.display = 'none';
        }

        function updateSummary() {
            let passedTests = Object.values(testResults).filter(result => result).length;
            let totalTests = Object.keys(testResults).length;
            
            let summaryHTML = '<h3>Test Results:</h3>';
            summaryHTML += '<p><strong>Passed:</strong> ' + passedTests + '/' + totalTests + '</p>';
            
            if (testResults.javascript) summaryHTML += '<div class="result success">‚úÖ JavaScript Working</div>';
            else summaryHTML += '<div class="result error">‚ùå JavaScript Issues</div>';
            
            if (testResults.localStorage) summaryHTML += '<div class="result success">‚úÖ Local Storage Working</div>';
            else summaryHTML += '<div class="result error">‚ùå Local Storage Issues</div>';
            
            if (testResults.cartFunctions) summaryHTML += '<div class="result success">‚úÖ Cart Functions Working</div>';
            else summaryHTML += '<div class="result error">‚ùå Cart Functions Issues</div>';
            
            if (testResults.modal) summaryHTML += '<div class="result success">‚úÖ Modal Working</div>';
            else summaryHTML += '<div class="result error">‚ùå Modal Issues</div>';
            
            if (passedTests === totalTests) {
                summaryHTML += '<div class="result success"><strong>üéâ All tests passed! Your cart system should work!</strong></div>';
                summaryHTML += '<p><strong>Recommendation:</strong> Use the working-cart-final.html as your main cart system.</p>';
            } else {
                summaryHTML += '<div class="result warning"><strong>‚ö†Ô∏è Some tests failed. This might explain cart issues.</strong></div>';
                summaryHTML += '<p><strong>Recommendation:</strong> Fix the failed tests or use the working-cart-final.html instead.</p>';
            }
            
            document.getElementById('summary').innerHTML = summaryHTML;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Cart diagnostic page loaded');
        });
    </script>
</body>
</html>
